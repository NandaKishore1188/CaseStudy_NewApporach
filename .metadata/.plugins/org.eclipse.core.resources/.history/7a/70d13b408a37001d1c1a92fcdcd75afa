package com.capg;

import static org.assertj.core.api.Assertions.assertThat;
import static org.mockito.Mockito.times;
import static org.mockito.Mockito.verify;

import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.springframework.boot.test.context.SpringBootTest;

import com.capg.dto.ProductDTO;
import com.capg.entity.Product;
import com.capg.repository.ProductsRepository;
import com.capg.service.ProductServiceImpl;

@SpringBootTest
class ShoppingCartProductServiceApplicationTests {

	@Test
	void contextLoads() {
	}
	 @Mock
	    private ProductsRepository productsRepository;

	    @InjectMocks
	    ProductServiceImpl productServiceImpl;

//	    @Before
//	    public void init() {
//	        MockitoAnnotations.initMocks(this);
//	    }

//	    @Test
//	    void isProductExistsById() {
//
//	        Product product = new Product(300,"Test",21.21,5, LocalDate.of(2022,01,01));
//	        productServiceImpl.addProducts(product);
//	        Product product1 =productsRepository.findById(300);
//	        if(!product1.isEmpty()) {
//	            Boolean actualResult = true;
//	                    assertThat(actualResult).isTrue();
//	        }
//	    }

	    @Test
	    void getProductsDataByProductName(){
	        Product drugsData1 = new Product(200,"Test",230,5);

	            productsRepository.save(drugsData1);
	            Optional<Product> actualResult = productsRepository.findByproductName("Test");
	            Boolean ac = actualResult.isEmpty();
	            assertThat(ac).isTrue();
	        }

//	            @Test
//	            public void getAllDrugsDataTest()
//	            {
//	                List<DrugsData> list = new ArrayList<DrugsData>();
//	                DrugsData drugsData1 = new DrugsData(300,"Test300",121.21,25,
//	                        LocalDate.of(2022,01,07));
//	                DrugsData drugsData2 = new DrugsData(400,"Test400",221.21,35,
//	                        LocalDate.of(2022,02,04));
//	                DrugsData drugsData3 = new DrugsData(500,"Test500",321.21,45,
//	                        LocalDate.of(2022,06,05));
//
//
//	                list.add(drugsData1);
//	                list.add(drugsData2);
//	                list.add(drugsData3);
//
//	                when(productsRepository.findAll()).thenReturn(list);
//
//	                //test
//	                List<DrugsData> drugsDataList = productServiceImpl.getAllDrugsData();
//
//	                assertEquals(3, drugsDataList.size());
//	                verify(productsRepository, times(1)).findAll();
//	            }
	//
	    @Test
	    public void saveProductsTest()
	    {

	        ProductDTO product = new ProductDTO(200,"Test200",300,5);
	        productServiceImpl.addProducts(product);
	        verify(productServiceImpl, times(1)).addProducts(product);
	    }
	}


